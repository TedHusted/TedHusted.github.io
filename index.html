<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Currents</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Business analysis, software engineering, continuous delivery.">
<meta property="og:type" content="website">
<meta property="og:title" content="Currents">
<meta property="og:url" content="http://TedHusted.github.io/index.html">
<meta property="og:site_name" content="Currents">
<meta property="og:description" content="Business analysis, software engineering, continuous delivery.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Currents">
<meta name="twitter:description" content="Business analysis, software engineering, continuous delivery.">
  
    <link rel="alternate" href="/atom.xml" title="Currents" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Currents</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Getting there from here</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://TedHusted.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-a-nimble-introduction-to-force-com" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/05/05/a-nimble-introduction-to-force-com/" class="article-date">
  <time datetime="2012-05-05T13:16:00.000Z" itemprop="datePublished">2012-05-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tutorials/">Tutorials</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/05/05/a-nimble-introduction-to-force-com/">A Nimble Introduction to Force.com</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://developer.force.com/" target="_blank" rel="external"><img src="http://www.developerforce.com/assets/developerforcesite/images/forcebug.png" alt=""></a>Compared to .NET or J2EE, developing on Force.com is both very familiar and very different. It’s familiar because you still follow the same-old Software Delivery Lifecycle. You write code, queries, and unit tests using familiar syntaxes and tools. When QA signs-off, you push components from development to production. And when users come up with something that we can do to make their lives easier, we do it all over again.  Of course, there are some notable differences …</p>
<p><a href="https://docs.google.com/document/pub?id=1N6_9Pf6RytmeMN2kabmcbymEVHUmJbjqcOKIj6Tmc_A" target="_blank" rel="external">In a brief, 12-page introduction, we walk through how the Force.com platform works, from a developers perspective. [Read More]</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/05/05/a-nimble-introduction-to-force-com/" data-id="cizbl1w4h0001fcx3bvsy1zmo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-office-data-silos-considered-harmful" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/04/26/office-data-silos-considered-harmful/" class="article-date">
  <time datetime="2012-04-26T17:00:00.000Z" itemprop="datePublished">2012-04-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Reviews/">Reviews</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/26/office-data-silos-considered-harmful/">Office Data Silos Considered Harmful</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="separator" style="clear:both;text-align:center;"><a href="http://collaborationforgood.org/2012/01/17/breaking-down-data-silos-in-the-cloud/" target="_blank" rel="external"><img src="https://tedhusted.files.wordpress.com/2012/04/dad73-opssilo.jpg" alt=""></a></div><br><div style="font-family:Arial;">One of the great pleasures we have when rolling out Nimble AMS is rolling up a multitude of Excel Data Silos into a single, shareable, Enterprise database.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">When people learn about Salesforce CRM and Nimble AMS, we find that too many organizations are hamstrung by their current solutions. Customizations are difficult, expensive, and need to be redone whenever there is a significant upgrade. Given such hurdles, it’s not surprising that people store important data in one-off Excel worksheets and Word documents, rather than go through the pain of customizing a shared solution.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"><a name="more"></a>OTOH, with Salesforce CRM and Nimble AMS, our customers are able to customize the application, quickly and easily, often without our help. Better yet, customizations continue to work, upgrade after upgrade, without having to add-on the same wheel over and over again.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Sound magical? To the Salesforce user, it sure seems that way. But, to quote the late, great, Arthur C. Clarke, “any sufficiently advanced technology is indistinguishable from magic”. In the case of Salesforce CRM, customizations are painless and eternal through the courtesy of three technologies: point-and-click programming, API versioning, and mandatory unit-test coverage.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"><strong>Point-and-Click Programming.</strong> From the beginning, the Salesforce mantra has been “No Software”, which not only means “no software to install”, but also “no software to write”. Many significant customizations can be created by any Salesforce power user via a point-and-click interface. You can add fields, tables, validation rules, workflows, UI screens, and more – without ever writing a line of code.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"><strong>API Versioning.</strong> While P&amp;C can accomplish 90% of what most people really need to do, sometimes a deeper customization is needed. When a Salesforce Developer adds a database trigger or other code-based customization, Salesforce transparently notes the current version of the application. Whenever that customization interacts with Salesforce, it continues to use the same version of the application program interface (API). Since Salesforce brings out three versions a year (like clockwork), come 2014, a future-you might be using version 30, but that 2012 customization is still talking to version 24. API versioning lets Salesforce continue to improve the platform, without breaking code that worked just fine yesterday.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"><strong>Mandatory Unit Test Coverage.</strong> Every day, Salesforce.com runs 50,000 automated tests against its own code base, and every new change has to pass that gauntlet before it ever makes it into a release. Likewise, code-based customizations made to an org must have a minimum unit test coverage of 75% before custom code can be deployed into a production org. That’s not a guideline: it’s a hard rule that the platform enforces.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Salesforce also upgrades all of the development environment “sandboxes”, automatically, in advance of every new release. Automatic sandbox upgrades gives those of us distributing a product with extensive customizations (like Nimble AMS) a chance to upgrade any of our own features for the latest and greatest improvements. And, when we do bring out an upgrade to our “managed package”, we can push improvements (and fixes) to all our customers, transparently, at once, just like Salesforce itself.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Taken together, these three technologies – Point-and-Click Programming, API Versioning, and Mandatory Unit Test Coverage – create an environment that is so sufficiently advanced that upgrades become painless and, well, automagical.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">For more about the Salesforce release cycle, check out “<a href="http://nimbleuser.com/blog.aspx?id=4116&amp;blogid=236" target="_blank" rel="external">All Aboard the Salesforce Release Train</a>“.</div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/04/26/office-data-silos-considered-harmful/" data-id="cizbl1w87005dfcx3alm1lwin" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-failing-safe-with-the-apex-data-loader-for-salesforce" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/04/07/failing-safe-with-the-apex-data-loader-for-salesforce/" class="article-date">
  <time datetime="2012-04-07T13:00:00.000Z" itemprop="datePublished">2012-04-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tutorials/">Tutorials</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/07/failing-safe-with-the-apex-data-loader-for-salesforce/">Failing safe with the Apex Data Loader for Salesforce</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="separator" style="clear:both;text-align:center;"><a href="http://blog.domaintools.com/2011/08/how-to-use-alerts-to-get-the-scoop-on-your-competitors/" target="_blank" rel="external"><br><img src="http://blog.domaintools.com/wp-content/uploads/2011/08/Alerts1.jpg" alt=""></a></div><br><div style="font-family:Arial;">If you have a way to pull and format data from another system, the <strong>Apex Data Loader</strong> is a great, on-demand way to push data into <strong>Salesforce CRM</strong>. Without much effort, you can automate the process and create a hands-free data sync. The tricky part is that while the Data Loader creates excellent logs, there’s no obvious way to alert a person when a data sync fails. Once a system is in place, failures are rare, but, in real life, stuff happens, and it’s helpful if failsafes are in place.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">A key problem is that the Apex Data Loader writes an error log whether there are errors or not. If the pass is 100% successful, the error log will have a header line and no rows.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">If the error log was only written when errors occurred, we could just look for the error logs, and process the files whenever they crop up. But, in this case, we first need to look inside the log and count the lines before we can be sure there was a failure.</div><br><div style="font-family:Arial;"></div><br><div><a name="more"></a><span class="Apple-style-span" style="font-family:Arial;">On a Windows-based system, one solution is to use a VB script, like </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">COUNTLN.VBS</span><span class="Apple-style-span" style="font-family:Arial;">, to count the number of lines in a file. </span></div><br><div style="font-family:Arial;"></div><br><div><br><br><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">‘ COUNTLN.VBS</span><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">‘ Description: Count the number of lines in a file and return as error level (up to 255)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">‘ Usage: cscript countln.vbs errors.csv</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">‘ Concept: <a href="http://blogs.technet.com/b/heyscriptingguy/archive/2004/10/12/how-can-i-count-the-number-of-lines-in-a-text-file.aspx" target="_blank" rel="external">http://blogs.technet.com/b/heyscriptingguy/archive/2004/10/12/how-can-i-count-the-number-of-lines-in-a-text-file.aspx</a></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">Const ForReading = 1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">Set objFSO = CreateObject(“Scripting.FileSystemObject”)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">Set objTextFile = objFSO.OpenTextFile (WScript.Arguments.Item(0), ForReading)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">objTextFile.ReadAll</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">‘ Wscript.Echo “Number of lines: “ &amp; objTextFile.Line</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">WScript.Quit(objTextFile.Line)</span></div><br></div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:Arial;">The </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">COUNTLN.VBS</span><span class="Apple-style-span" style="font-family:Arial;"> script sets the exit condition, which can then be tested in a DOS Batch file, like </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CHECKLOG.BAT</span><span class="Apple-style-span" style="font-family:Arial;">.</span></div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">@ECHO OFF</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">REM CHECKLOG.BAT</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">REM Count the lines and send the errors, if any</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">ECHO CountLn: %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CSCRIPT ..\countln.vbs %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF ERRORLEVEL 1 ECHO Line Count: %errorlevel%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF ERRORLEVEL 3 ..\7z.exe a %2 %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">ERASE %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">ECHO Checklogs process complete.</span></div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">The Apex Data Loader takes as input a common-separated-value (CSV) or a tab-delimited file. The first row of the input file is a header detailing the input columns, with each subsequent row representing a record to be sent to the target Salesforce CRM object.</div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:Arial;">When the Apex Data Loader runs, it creates an </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">success(ID).log</span><span class="Apple-style-span" style="font-family:Arial;"> and an </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">error(ID).log</span><span class="Apple-style-span" style="font-family:Arial;">. The (ID) is replaced with a timestamp shared by the companion success and error logs. Both logs contain a header row, and a row for each input row, detailing the data processed for each column. The success log contains all the rows that made it into Salesforce. The error logs contains all the rows that did not cross over. </span></div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Conveniently, the logs can also be used as input files. If the errors can be easily fixed, you can resubmit the error log to the Apex Data Loader, without going back to the external system.</div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:Arial;">The </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CHECKLOG.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> file is designed to add the matching error files to a compressed archive file in the widely-supported ZIP format. Here we’re using the </span><a href="http://www.7-zip.org/" target="_blank" rel="external">open source 7z utility</a><span class="Apple-style-span" style="font-family:Arial;"> to create the archive, but others would work as well. In this way, if </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CHECKLOG</span><span class="Apple-style-span" style="font-family:Arial;"> is is not run as often as the Apex Data Loader itself, the process can support a single file or multiple files. And, if the data is sensitive, most ZIP utilities support encrypting the archive. </span></div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Given a secure ZIP archive, email can be a great way to get the error logs to an administrator who can address the problems. Staying with our Windows platform theme, here’s another VB script that can send an email alert, with an attachment, to a Gmail account.</div><br><div style="font-family:Arial;"></div><br><div><br><br><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">‘Usage: cscript sendmail.vbs &lt;<a href="mailto:email_recipient@example.com" target="_blank" rel="external">email_recipient@example.com</a>&gt; “” “” “”</span><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">‘Ex. No attach: cscript sendmail.vbs <a href="mailto:example@gmail.com" target="_blank" rel="external">example@gmail.com</a> “test subject line” “test email body”</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">‘Ex. W/ attach: cscript sendmail.vbs <a href="mailto:example@gmail.com" target="_blank" rel="external">example@gmail.com</a> “test subject line” “test email body” “c:\scripts\log.txt”</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">‘Attachment path cannot be relative</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">‘Credit: <a href="http://cybernetnews.com/vbscript-send-emails-using-gmail/" target="_blank" rel="external">http://cybernetnews.com/vbscript-send-emails-using-gmail/</a></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">‘<strong><em> CONFIGURE THE FROM EMAIL ADDRESS AND PASSWORD </em></strong></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">Const fromEmail = “(TBD)@gmail.com”</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">Const password = “(TBD)”</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">‘<strong><em> END OF CONFIGURATION </em></strong></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">Dim emailObj, emailConfig</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">Set emailObj = CreateObject(“CDO.Message”)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailObj.From = fromEmail</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;"><a href="http://emailObj.To/" target="_blank" rel="external">emailObj.To</a> = WScript.Arguments.Item(0)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailObj.Subject = WScript.Arguments.Item(1)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailObj.TextBody = WScript.Arguments.Item(2)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">If WScript.Arguments.Count &gt; 3 Then</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailObj.AddAttachment WScript.Arguments.Item(3)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">End If</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">Set emailConfig = emailObj.Configuration</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields(“<a href="http://schemas.microsoft.com/cdo/configuration/smtpserver" target="_blank" rel="external">http://schemas.microsoft.com/cdo/configuration/smtpserver</a>“) = “<a href="http://smtp.gmail.com/" target="_blank" rel="external">smtp.gmail.com</a>“</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields(“<a href="http://schemas.microsoft.com/cdo/configuration/smtpserverport" target="_blank" rel="external">http://schemas.microsoft.com/cdo/configuration/smtpserverport</a>“) = 465</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields(“<a href="http://schemas.microsoft.com/cdo/configuration/sendusing" target="_blank" rel="external">http://schemas.microsoft.com/cdo/configuration/sendusing</a>“) = 2</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields(“<a href="http://schemas.microsoft.com/cdo/configuration/smtpauthenticate" target="_blank" rel="external">http://schemas.microsoft.com/cdo/configuration/smtpauthenticate</a>“) = 1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields(“<a href="http://schemas.microsoft.com/cdo/configuration/smtpusessl" target="_blank" rel="external">http://schemas.microsoft.com/cdo/configuration/smtpusessl</a>“) = true</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields(“<a href="http://schemas.microsoft.com/cdo/configuration/sendusername" target="_blank" rel="external">http://schemas.microsoft.com/cdo/configuration/sendusername</a>“) = fromEmail</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields(“<a href="http://schemas.microsoft.com/cdo/configuration/sendpassword" target="_blank" rel="external">http://schemas.microsoft.com/cdo/configuration/sendpassword</a>“) = password</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailConfig.Fields.Update</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">emailObj.Send</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">Set emailobj = nothing</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">Set emailConfig = nothing</span></div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"></div><br></div><br><div style="font-family:Arial;">Of course, the notion is that you create a special Gmail account just to receive the alerts and then forward to an administrator from there.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">While we have the pieces in place for handling the error logs, there is also the problem of what to do with the success logs. The Apex Data Loader kindly generates both logs, that between them, contain all of the detail found in the original input file, for each and every pass.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">While this level of detail is great (really-really-great), if you are running a sync every five minutes, retrieving a log later can be a real “cant-see-the-forest–for-the-trees” headache.</div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:Arial;">Long story short, in addition to error alerts, an automated Apex Data Loader sync also needs help with general log management. The </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">ARCHIVE.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> file is designed to be run at least once a day, but could also be run every hour. It sweeps all of the success logs into an archive for the current date, and, as discussed, emails the error logs to a Gmail account. </span></div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:Arial;">To deploy the system, beneath the current logging folder (usually “Status”), create an Archive folder, and beneath that create Success and Error folders. Put the </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">ARCHIVE.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> and VBS files under the Archive folder (along with the 7z utility), and the </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CHECKLOG.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> under the </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">Error</span><span class="Apple-style-span" style="font-family:Arial;"> folder. </span></div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">\Status</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">.\Archive</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- archive.bat</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- countln.vbs</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- sendmail.vbs</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- 7z.exe</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- 7z.dll</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- 7z-zip.dll</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">.\Archive\Error</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- checklog.bat</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">.\Archive\Success</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">- checklog.bat</span></div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:Arial;">A call to </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">ARCHIVE.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> can be queued as a Windows Scheduled Task to run every hour, or once a day, depending on how often the Apex Data Loader runs. The system moves the logs out of .\Status and creates a ZIP for each day under </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">.\Status\Archive</span><span class="Apple-style-span" style="font-family:Arial;"> in the format </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">“LOGS-YYMMDD.ZIP”</span><span class="Apple-style-span" style="font-family:Arial;">  (while emailing the error logs to the Gmail account). Temporary copies of the Success and Error logs are also put into the Success and Error folders, for processing by </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CHECKLOG.BAT</span><span class="Apple-style-span" style="font-family:Arial;">.</span></div><br><div style="font-family:Arial;"></div><br><div><br><br><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">@ECHO OFF</span><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM ARCHIVE.BAT</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Email non-empty Data Loader error logs to a GMail account and</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM archive to a zip file all other log files (<em>.csv).</em></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Main file to call from a scheduled task.</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Intended to be launched from a subdirectory directly beneath the log folder.</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Expects an error\ subdirectory to exist (status\archive\error).</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Temporarily stores error logs being emailed in errorlog.zip and</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM calls archivelogs.bat to store logs by date in LOGS-20??-??-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Uses as dependencies: checklog.bat, countln.vbs, sendmail.vbs, 7z.<em></em></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Checklog.bat is stored in subdirectories .\error and .\success. </span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM All others in status\archive next to this file.</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Bring logs down to a working folder, to avoid gaps in process</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF EXIST ..\.csv MOVE ..*.csv .</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF NOT EXIST <em>.csv GOTO Done</em></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Buffer errors and archive latest logs (\error must exist)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF EXIST error.csv COPY error<em>.csv error\</em></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF EXIST success.csv COPY success<em>.csv success\</em></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">SET TDate=%date:~10,4%%date:~4,2%%date:~7,2%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">.\7z.exe a LOGS-%TDate%.zip .csv</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF ERRORLEVEL 1 GOTO Done</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF NOT EXIST LOGS-%TDate%.zip GOTO Done</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">ERASE <em>.csv</em></span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Cleanup errorlog.zip before calling errorlogs.bat</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">SET ZIP=(TBD: Full path to a local working directory)\errorlog.zip</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF EXIST %ZIP% ERASE %ZIP%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Call checklog for each error log.</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">CD error</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">FOR %%x IN ( error.csv ) DO CMD.EXE /C checklog.bat %%x %%ZIP%%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">ECHO Emailing: %ZIP%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Attachment path cannot be relative</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">CSCRIPT ..\sendmail.vbs <a href="mailto:ccsa.alert@gmail.com" target="_blank" rel="external">ccsa.alert@gmail.com</a> “Alert! Data Load Failed.” “The Data Loader was unable to push records to Salesforce.” “%ZIP%”</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">CD ..</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Cleanup successlog.zip before calling checklogs.bat</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">SET ZIP=(TBD: Full path to a local working directory)\successlog.zip</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">IF EXIST %ZIP% ERASE %ZIP%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Call checklog for each success log.</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM –</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">CD success</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">FOR %%x IN (success*.csv ) DO CMD.EXE /C checklog.bat %%x %%ZIP%%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">ECHO Emailing: %ZIP%</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">REM Attachment path (%ZIP%) cannot be relative</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">CSCRIPT ..\sendmail.vbs (TBD@TBD.COM) “Alert! Data Load Succeeded.” “The Data Loader was able to push records to Salesforce.” “%ZIP%”</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">CD ..</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">:Done</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:xx-small;">ECHO Archive process complete.</span></div><br><div style="font-family:Arial;"></div><br></div><br><div><span class="Apple-style-span" style="font-family:Arial;">The second </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CHECKLOG</span><span class="Apple-style-span" style="font-family:Arial;"> call to the success folder is optional. When left in place, the system will email the success and error logs separately, in case the administrator wants assurance that the system is running successfully on schedule. </span></div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:Arial;">Another option would be to check for certain types of fatal errors. One fatal case would be someone renaming a target field in Salesforce without updating the Apex Data Loader configuration. If the mapping file refers to a field that no longer exists, the Data Loader generates a zero-length success log (with not even a header row). The </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">CHECKFATAL.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> alternative only ZIPs for emailing any success logs that are totally empty. </span></div><br><div style="font-family:Arial;"></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">@ECHO OFF</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">REM CHECKFATAL.BAT</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">REM Count the lines and send only fatal errors, if any. Only use in Success folder.</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">ECHO CountLn: %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">CSCRIPT ..\countln.vbs %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">IF ERRORLEVEL 2 ERASE %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">IF EXIST %1 ..\7z.exe a %2 %1</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;">ECHO Check fatal process complete.</span></div><br><div></div><br><div><span class="Apple-style-span" style="font-family:Arial;">The final touch is to prune the logs every so often. The </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">PRUNELOGS.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> batch file can be run once a month, on the first of the month. Based on the date represented by the file name, </span><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">PRUNELOGS.BAT</span><span class="Apple-style-span" style="font-family:Arial;"> retains 2-3 months of logs, based on the current month, and deletes the rest. </span></div><br><div style="font-family:Arial;"></div><br><div><br><br><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">@ECHO OFF</span><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">REM PRUNELOGS.BAT</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">REM ZIP delete the archive for month before last (retain 2-3 months of logs)</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">REM Intended to be called on the 1st day of each month</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">SET MM %date:~-10,2</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “01” ERASE LOGS-20??-11-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “02” ERASE LOGS-20??-12-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “03” ERASE LOGS-20??-01-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “04” ERASE LOGS-20??-02-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “05” ERASE LOGS-20??-03-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “06” ERASE LOGS-20??-04-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “07” ERASE LOGS-20??-05-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “08” ERASE LOGS-20??-06-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “09” ERASE LOGS-20??-07-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “10” ERASE LOGS-20??-08-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “11” ERASE LOGS-20??-09-??.ZIP</span></div><br><div><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">IF “%MM%“ == “12” ERASE LOGS-20??-10-??.ZIP</span></div><br><div style="font-family:Arial;"></div><br></div><br><div style="font-family:Arial;">With these patches in place, the Apex Data Loader can be a safe and reliable way to automatically import data files generated by another system. Though, no data integration system is foolproof, and you should still devise a custom validation report that runs every day to confirm that data is flowing into the system as expected.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"><br><br>While it would be wonderful if we could originate and retain all of our enterprise data only in Salesforce CRM, in real life, we still need to integrate with other systems, and, when we do, tools like the Apex Data Loader, with a pinch of salt, can help us get the job done.<br><br>For more Data Loader tips, drop by the blog <a href="http://www.apexdataloader.com/" target="_blank" rel="external">Using the Apex Data Loader with Salesforce</a>.<br><br></div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/04/07/failing-safe-with-the-apex-data-loader-for-salesforce/" data-id="cizbl1w6f002dfcx3kwhfohuy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-salesforce-open-source-pioneer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/04/04/salesforce-open-source-pioneer/" class="article-date">
  <time datetime="2012-04-04T17:00:00.000Z" itemprop="datePublished">2012-04-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Essays/">Essays</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/04/salesforce-open-source-pioneer/">Salesforce – Open Source Pioneer</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><div class="separator" style="clear:both;text-align:center;"><a href="http://opensource.org/" target="_blank" rel="external"><img src="http://opensource.org/files/garland_logo.png" alt=""></a></div><br><strong><span class="Apple-style-span" style="font-family:inherit;"><br></span></strong></p>
<p><div style="display:inline !important;"><span class="Apple-style-span" style="font-family:inherit;">Before joining NimbleUser, I spent a decade working with open source software and participating in open source communities. Being part of an open source community, and helping to improve tools we use every day, is an enlightening experience, outside the scope of simple blog entry.<br></span></div></p>
<p><div style="display:inline !important;"></div></p>
<p><div><span class="Apple-style-span" style="font-family:inherit;">And I miss it. I’ve tried to stay involved with new projects like Vosao CMS, I answer mail sent to human-response at apache-dot-org, I speak at ApacheCon when I can, and I’m trying to bootstrap an advocacy site with Tim O’Brien. But, it’s a struggle to keep up with other projects when I’m still learning so much every day about the Salesforce CRM platform. </span></div><br><span class="Apple-style-span" style="font-family:inherit;">One consolation is that Salesforce is built with many products I touched during my open source decade. I worked with Doug Cutter and Jon Stevens to migrate Lucene to Apache Jakarta. Salesforce uses several Apache Commons products that I helped create (along with the Commons itself). So, although I don’t get to work on open source projects as much as I used to, I am grateful to be working with a solid, thoughtful product built on a backbone of truly awesome open source components</span></p>
<h2 id="Core-infrastructure"><a href="#Core-infrastructure" class="headerlink" title="Core infrastructure"></a>Core infrastructure</h2><p><a href="http://www.salesforce.com/customer-resources/learning-center/" target="_blank" rel="external"><img src="http://www2.sfdcstatic.com/common/assets/img/logo-new.png" alt=""></a>Salesforce.com pioneered cloud computing. Its combined Software-as-a-Service and Platform-as-a-Service offering handles 100,000+ customers, over 2.1 million users, 30+ million lines of third-party code, and hundreds of terabytes of data, running on its own blend of open source, proprietary, and custom code. [<a href="http://www.blogger.com/blogger.g?blogID=5208774#Resources" target="_blank" rel="external">Wikipedia</a>]</p>
<p>While the Salesforce platform uses the Oracle Database system as the basis as its backend data store, the web infrastructure is powered by several open source products, like <strong>Caucho Resin</strong>. The Resin Application Server is a high-performance XML application server for use with JSPs, servlets, JavaBeans, XML, and a host of other technologies. [<a href="http://www.blogger.com/blogger.g?blogID=5208774#Resources" target="_blank" rel="external">Hurwitz</a>]</p>
<h2 id="Fulltext-search"><a href="#Fulltext-search" class="headerlink" title="Fulltext search"></a>Fulltext search</h2><p>To help users find data quickly and easily, in 2002, Salesforce.com added the open source <strong>Apache Lucene</strong> search engine to its technology stack. Today, Lucene to manages an eight terabyte index of about twenty billion documents on the Salesforce platform. The Salesforce/Lucene cluster consists of roughly sixteen machines, which in turn contain many small (sharded) Lucene indexes. The system handles roughly 4000 queries per second, and it provides an incremental indexing model where the new Salesforce user data is searchable within approximately three minutes, through use of a custom optimizer. [<a href="http://www.blogger.com/blogger.g?blogID=5208774#Resources" target="_blank" rel="external">Igvita</a>]</p>
<h2 id="Quality-assurance"><a href="#Quality-assurance" class="headerlink" title="Quality assurance"></a>Quality assurance</h2><p>Salesforce.com brings out three major releases a year, and to keep development on track, their quality assurance team runs 50,000 tests a day. About 20,000 of those tests run under the open source <strong>Selenium</strong> web application testing system. Selenium supports exporting tests to native application languages, like Java and C#, and a Salesforce.com engineer open sourced an extension for its own language, Apex. [<a href="http://www.blogger.com/blogger.g?blogID=5208774#Resources" target="_blank" rel="external">Porro, Nagata</a>]</p>
<h2 id="User-facing-tools"><a href="#User-facing-tools" class="headerlink" title="User-facing tools"></a>User-facing tools</h2><p>Several of the Salesforce external data manipulation tools are built with open source components or are themselves open source. The indispensible <strong>Salesforce IDE</strong> is an <strong>Eclipse</strong> plugin. The popular <strong>Force.com Excel Connector</strong> is hosted at code.google.com. Responses to Outbound Messages are handled by the <strong>Apache Commons Connection Pool</strong>. The very useful <strong>Apex Data Loader</strong> is powered by the <strong>Spring Framework</strong> and <strong>Apache Commons BeanUtils</strong>. Since the Data Loader is open source, an OSX version sprang up (<strong>LexiLoader</strong>), and there is also an open source wizard (<strong>DataLoaderCliq</strong>) to help with Data Loader automation.</p>
<h2 id="Advocacy"><a href="#Advocacy" class="headerlink" title="Advocacy"></a>Advocacy</h2><p>At its 2011 Dreamforce Conference, Salesforce.com offered an entire track of presentations that encouraged users to adopt other open source tools, including a developer session entitled “<strong>Build Better Apps with Open Source</strong>”. On an ongoing basis, Salesforce.com hosts an <strong>Open Source forum</strong> as part of its support site. [<a href="http://www.blogger.com/blogger.g?blogID=5208774#Resources" target="_blank" rel="external">SFDC</a>]</p>
<p>By leveraging a solid core of open source packages, and mixing in its own proprietary customizations, Salesforce is able to deliver a robust, configurable platform, upon which millions of business users rely every day.</p>
<p><span class="Apple-style-span" style="font-size:24px;font-weight:bold;">Products mentioned</span></p>
<ul>
<li><a href="http://www.salesforce.com/" target="_blank" rel="external">Salesforce CRM</a></li>
<li><a href="http://www.caucho.com/resin/" target="_blank" rel="external">Caucho Resin</a></li>
<li><a href="http://lucene.apache.org/java/docs/index.html" target="_blank" rel="external">Apache Lucene</a></li>
<li><a href="http://seleniumhq.org/" target="_blank" rel="external">Selenium</a></li>
<li><a href="http://eclipse.org/" target="_blank" rel="external">Eclipse</a></li>
<li><a href="http://wiki.developerforce.com/page/Apex_Data_Loader" target="_blank" rel="external">Force.com Excel Connector</a></li>
<li><a href="http://commons.apache.org/dbcp/" target="_blank" rel="external">Apache Commons Database Connection Pool</a></li>
<li><a href="http://wiki.developerforce.com/page/Apex_Data_Loader" target="_blank" rel="external">Apex Dataloader</a></li>
<li><a href="http://commons.apache.org/beanutils/" target="_blank" rel="external">Apache Commons BeanUtils</a></li>
<li><a href="http://www.springsource.org/" target="_blank" rel="external">Spring Framework</a></li>
<li><a href="http://www.pocketsoap.com/osx/lexiloader/" target="_blank" rel="external">LexiLoader</a></li>
<li><a href="http://code.google.com/p/dataloadercliq/" target="_blank" rel="external">DataLoaderCliq</a></li>
</ul>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a><a href="http://www.blogger.com/blogger.g?blogID=5208774" target="_blank" rel="external">References</a></h2><ol>
<li>[Hurwitz] <a href="http://judithbalancingact.com/2008/05/29/is-there-beef-behind-salesforcecom/" target="_blank" rel="external">Is there beef behind SalesForce.Com?</a></li>
<li>[Wikipedia] <a href="http://en.wikipedia.org/wiki/Salesforce.com" target="_blank" rel="external">Salesforce.com.</a></li>
<li>[Igvita] <a href="http://www.igvita.com/2010/10/22/open-source-search-with-lucene-solr/" target="_blank" rel="external">Lucene in the wild: Salesforce, LinkedIn, Twitter, et al.</a></li>
<li>[Porro, Nagata] <a href="http://www.youtube.com/watch?v=TXNI9SRW1sY" target="_blank" rel="external">How to test Salesforce Apps with Selenium.</a></li>
<li>[SFDC] <a href="http://wiki.developerforce.com/page/Apex_Data_Loader" target="_blank" rel="external">Apex Data Loader</a>, <a href="http://developer.force.com/dreamforce/11/session/Build-Better-Apps-Using-Open-Source-Code" target="_blank" rel="external">Build Better Apps Using Open Source</a>, <a href="http://blogs.developerforce.com/reid-carlberg/2011/08/dreamforce-open-source-lab-sponsored-by-github-schedule.html" target="_blank" rel="external">Open Source Labs tract</a>, <a href="http://boards.developerforce.com/t5/Open-Source/bd-p/sforceExplorer" target="_blank" rel="external">Open Source Forum</a>.</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/04/04/salesforce-open-source-pioneer/" data-id="cizbl1w9c006ufcx3chwlbsl0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Open-Source/">Open Source</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sun-goes-nova-cloud-intact" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/04/01/sun-goes-nova-cloud-intact/" class="article-date">
  <time datetime="2012-04-01T09:00:00.000Z" itemprop="datePublished">2012-04-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Essays/">Essays</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/01/sun-goes-nova-cloud-intact/">Sun goes Nova. Cloud intact.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="separator" style="clear:both;text-align:center;"><a href="https://www.youtube.com/watch?v=6KTb8CJoj04" target="_blank" rel="external"><img src="https://i.ytimg.com/vi/6KTb8CJoj04/hqdefault.jpg" alt=""></a></div><br>The Internet was designed to survive a nuclear holocaust, but no one expected to find social media networks still available after the Sun’s surprise flare-up on Saturday.<br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">“While we talk about the bits being in the cloud, most of the Internet is actually underground,” explained Internet Guru <a href="http://securitytango.com/" target="_blank" rel="external">Nick Francesco</a>. “Although the solar flare burned off the ozone, condemning us all to a slow painful death, the good news is that we can still tweet about it.”</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Saturday’s Twitter volume during the flare eclipsed the recent record set during the season finale of <a href="http://twitpic.com/929lsx]" target="_blank" rel="external">Pretty Little Liars</a>. The light from the flare made earthfall at 7:48a EST, had its own Twitter account (<a href="https://twitter.com/#!/AngiesRightLeg" target="_blank" rel="external">@SunFlare</a>) by 7:50a, and 439,624 followers by 8:15a. By noon, over 700,000 tweets referenced the flare, including choice nuggets like<br><a name="more"></a></div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"><span class="Apple-style-span" style="color:#666666;">@Ecc19 “</span>Wow! Something new over the earth.”</div><br><div style="font-family:Arial;"><span class="Apple-style-span" style="color:#666666;">@SmileKid13</span> “#WorstDayEver #SunGoesViral.”</div><br><div style="font-family:Arial;"><span class="Apple-style-span" style="color:#666666;">@Groupon</span> “Designer Sunglasses - B1G1 - today only!</div><br><div style="font-family:Arial;"><span class="Apple-style-span" style="color:#666666;">@JStorm</span> “Flame On!”</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Elsewhere, <a href="http://www.youtube.com/watch?v=Nnl-yQjGYBs&amp;feature=related" target="_blank" rel="external">Facebook</a> exploded with blurry iPhone photos of a dilating ball of light, and most <a href="http://thecynicalgirl.com/your-linkedin-group-probably-sucks/" target="_blank" rel="external">LinkedIn</a> statuses changed to “Ready to move. Call me.”. The flare passed through <a href="http://www.facebook.com/pages/Google-Plus-Sucks/202649716452006" target="_blank" rel="external">Google+ </a>without a ripple, since most of the plussies were busy updating their last known address on <a href="http://www.youtube.com/watch?v=CznVPlAunk8" target="_blank" rel="external">Plaxo</a>.</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;">Salesforce expects <a href="http://www.youtube.com/watch?v=chkLP6FdUZA" target="_blank" rel="external">Chatter</a> volume to soar on Monday, as burn-outs return to work after a long, hairy weekend. “The flare is a real opportunity for growth,” blogged founder Marc Benioff. “Nothing brings out net-new leads like a good fire sale.”</div><br><div style="font-family:Arial;"></div><br><div style="font-family:Arial;"><br><div>For more, see</div><br><div><br><br><em>   <a href="http://tedhusted.blogspot.com/2009/04/twitter-too-much-and-not-enough.html" target="_blank" rel="external">Too Much Twitter and Not Enough</a>
</em>   <a href="http://tedhusted.blogspot.com/2007/04/geeks-glossary-asf-edition-recently-we.html" target="_blank" rel="external">Geeks Glossary</a><br><em>   <a href="http://tedhusted.blogspot.com/2006/04/truth-with-jokes-q-are-asf-committers.html" target="_blank" rel="external">The Truth with Jokes </a>
</em>   <a href="http://en.wikipedia.org/wiki/April_Fools%27_Day" target="_blank" rel="external">The Truth without Jokes</a><br>*   and … <a href="http://www.youtube.com/watch?v=NfZ4q86ekS4&amp;context=C4be1ba2ADvjVQa1PpcFNeL5vOXud6ym9Iyt54c-yNBuBvySkkoVQ=" target="_blank" rel="external">How Geeks Should Prepare for Disaster</a><br></div><br></div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/04/01/sun-goes-nova-cloud-intact/" data-id="cizbl1w9x007vfcx3e4e734os" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Satire/">Satire</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-catch-me-on-the-flip-side-responding-to-outbound-messages-in-salesforce-crm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/03/29/catch-me-on-the-flip-side-responding-to-outbound-messages-in-salesforce-crm/" class="article-date">
  <time datetime="2012-03-29T09:00:00.000Z" itemprop="datePublished">2012-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tutorials/">Tutorials</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/29/catch-me-on-the-flip-side-responding-to-outbound-messages-in-salesforce-crm/">Catch me on the flip-side: Responding to Outbound Messages in Salesforce CRM</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><div class="separator" style="clear:both;text-align:center;"><a href="https://www.flickr.com/photos/spacemanbob/1084139169" target="_blank" rel="external"><img src="https://farm2.staticflickr.com/1130/1084139169_e272bc1f81_z.jpg" alt=""></a></div><br>In a <a href="http://tedhusted.blogspot.com/2012/03/unloading-salesforce-crm-data-with.html" target="_blank" rel="external">previous blog</a>, we walked through example code for an Outbound Message Listener. We covered the essentials, but Salesforce CRM offers a nifty twist on just sending an outbound message to an external system. Not only can a system receive a message, it can send back a response. For example, if the outbound message inserts a record, the external system can send back the record’s key.</p>
<p><a name="more"></a>Our example Listener called a worker method that handled the messages in a foreach loop. Using the case of returning an external key, we can add the keys to a hashtable, and send back a batch at the end all of the responses. We’ll pickup the live action towards the end of the foreach loop from the <a href="http://tedhusted.blogspot.com/2012/03/unloading-salesforce-crm-data-with.html" target="_blank" rel="external">previous example</a>.</p>
<p><pre> <strong>Hashtable responsePayload = newHashtable();  // Returns IDs to SF</strong><br> foreach (AccountNotification message in n.Notification)<br> {<br>     sf = message.sObject;</pre></p>
<p><pre>     // – Check cache –<br>     // …<br>     // – handle message –<br>     // …<br>     // Queue ID for return to SF<br>     <strong>responsePayload.Add(sf.Id, my.Id);</strong><br> } // end foreach loop<br> // – Return IDs to SF –<br> <strong>log.Info(“Info: Sending response to Salesforce …”);</strong><br> <strong>Response response = new Response();</strong></pre></p>
<p><pre> <strong>log.Info(response.Send(“Account”, responsePayload));</strong><br> return;<br>}</pre><br>The Response class is a wrapper around a <span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;">SForceService</span> instance which returns a String we can use as a logging statement.</p>
<p><pre>class Response<br>{<br>    private SforceService service;<br>    public Response() { }<br>    public String Send(String objectName, Hashtable payload)<br>    {<br>        return this.Send(objectName, payload, “External_Id__c”);<br>    }<br>    public String Send(String objectName, Hashtable payload, String syncFieldName)<br>    {<br>        if (payload == null || payload.Count == 0) return</pre></p>
<p><pre>            “No records updated. Response.Send() not needed.”;<br>        try<br>        {<br>            service = new SforceService();<br>            LoginResult loginResult = service.login(<br>                ConfigurationManager.AppSettings[“Salesforce.Username”],<br>                ConfigurationManager.AppSettings[“Salesforce.Password”] +<br>                ConfigurationManager.AppSettings[“Salesforce.Token”]<br>            );<br>            service.SessionHeaderValue = new SessionHeader();<br>            service.SessionHeaderValue.sessionId = loginResult.sessionId;<br>            service.Url = loginResult.serverUrl;<br>            GetUserInfoResult userInfo = loginResult.userInfo;<br>            List sObjects = new List();<br>            sObject s = new sObject();<br>            XmlDocument xmlDocument = new XmlDocument();<br>            List elements;<br>            XmlElement element;<br>            foreach (String sfid in payload.Keys)<br>            {<br>                s = new sObject();<br>                s.Id = sfid;<br>                s.type = objectName;<br>                elements = newList();<br>                element = xmlDocument.CreateElement(syncFieldName);<br>                element.InnerText = ht[sfid].ToString();<br>                elements.Add(element);<br>                s.Any = elements.ToArray();<br>                sObjects.Add(s);<br>            }<br>            SaveResult[] saveResults = service.update(sObjects.ToArray());<br>            String output = String.Empty;<br>            foreach (SaveResult sr in saveResults)<br>            {<br>                if (sr.success)<br>                {<br>                    output += String.Format(</pre></p>
<p><pre>“{0} Response Sync Success : sf.id=\”{1}\””, objectName, sr.id) + “\n”;<br>                }<br>                else<br>                {<br>                    foreach (Error err in sr.errors)<br>                    {<br>                        output += String.Format(</pre></p>
<p><pre>“{0} Response Sync Error : sf.id=\”{1}\”, {2}”, objectName, sr.id, err.message) +</pre></p>
<p><pre>“\n”;<br>                    }<br>                }<br>            }<br>            return output;<br>        }<br>        catch (Exception ex)<br>        {<br>            return ex.Message + “ — “ + ex.StackTrace;<br>        }<br>    }<br>}</pre><br>The credentials and API service endpoint are declared in the Web.Config file.</p>
<p><pre></pre><br><a href="https://test.salesforce.com/services/Soap/u/24.0" target="_blank" rel="external">https://test.salesforce.com/services/Soap/u/24.0</a></p>
<p>(In a production environment, replace “test.salesforce.com” with “www.salesforce.com”.)</p>
<p>Some caveats are</p>
<p>(1) The response needs credentials to login, and you might need to setup a system account for the response.</p>
<p>(2) To keep the message from recursing, the Response User needs to have outbound messaging disabled, or be specifically excluded from the Outbound Messaging Workflow.</p>
<p>(3) If your listener implements a producer/consumer queue, the response may not be immediate. (If tens of thousands of records are being updated by a slow system, it could be an hour or more!).</p>
<p>(4) An outbound message response may update the record while it’s being viewed by another user. If the user makes another change without refreshing the record, Salesforce will decline the second change, and the human user will have to refresh and repeat.</p>
<p>By allowing a response to an outbound message, Salesforce gives us the opportunity to close the loop. For example, if a record is being inserted into an external system, the response could return the external ID, for use with future updates.</p>
<p>While not a “point-and-click” product, like the Apex Dataloader, the outbound messaging API provides developers all the hooks we need to create a full-service data connection.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/03/29/catch-me-on-the-flip-side-responding-to-outbound-messages-in-salesforce-crm/" data-id="cizbl1w5w001kfcx3qv5xov5w" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-in-data-we-trust" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/03/27/in-data-we-trust/" class="article-date">
  <time datetime="2012-03-27T09:00:00.000Z" itemprop="datePublished">2012-03-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Essays/">Essays</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/27/in-data-we-trust/">In Data We Trust</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="separator" style="clear:both;text-align:center;"><a href="http://www.redcross.org/" target="_blank" rel="external"><img src="https://tedhusted.files.wordpress.com/2012/03/fa1a2-blood-drop.jpg" alt=""></a></div><div>Data is the lifeblood of a company. When data flows freely to those who need it most, business booms. But, should the flow stop, a business fails. According to the National Archives &amp; Records Administration, after a major data loss or extended data center outage (of ten days or more), most companies shut down within a year of the disaster. </div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;">Despite the stakes, according to a national survey, many business do not have proper data backup. </span></div><div><div><br><br><em>   40% of Small and Medium Sized Businesses don’t back up their data at all.
</em>   Up to 50% of all backups are not fully recoverable and up to 60% of all backups fail in general.<br><em>   Since 2003, the majority of North American workers are mobile.
</em>   One-third of all computers sold are laptops, and 60% of all data is held on PC Desktops and laptops.<br><em>   15% or more of laptop computers are stolen or suffer hard drive failures.</em></div><div><a name="more"></a>To avoid becoming a statistic, every day, more and more businesses are looking to cloud-based software-as-a-service vendors to provide a one-stop IT shop. </div></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;">When workers have instant access to data and files through a web browser, people don’t feel the need to store key data on local machines. When data is centralized on the cloud, it can be backed up and maintained by the best and the brightest. Between Google Apps and Salesforce CRM, many professionals will have all the software they need, saving the cost of licensing and maintaining complex office suites. Today, cloud-based offices can securely access their data from any machine with an Internet connection and work seamlessly from any location.</span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;">Of course, when a company moves core data to the cloud, it must be just as careful when choosing a IT provider as it should be when choosing IT personnel. The Salesforce CRM platform offers businesses a number of key safeguards, including trust.salesforce.com, release trains, and superb test coverage.  </span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;"><strong>trust.salesforce.com</strong> </span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;">Saleforce.com believes that trust starts with transparency, and provides real-time information on system performance and security on a public web site that  anyone can visit at trust.salesforce.com. The <a href="http://trust.salesforce.com/trust/status/" target="_blank" rel="external">System Status panel</a> lists each of the Salesforce servers, flagging any current performance issues, and providing a RSS feed with historical information going back to Sep 2010. The trust.salesforce.com site also provides customers with background information on data integrity, security, and overall best practices. </span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;"><strong>Release Trains</strong></span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;">Like clockwork, three times a year, Salesforce rolls out a major new release. All customers are upgraded automatically and seamlessly, at no additional cost, ensuring that everyone has all the latest fixes and improvements. The train model means that Salesforce.com can bring out new features incrementally. When the next train will be along in a couple of months, there’s no need to rush an under-developed feature to market. Certified administrators and developers must also pass a maintenance exam for every new release, assuring that key people are aware of the latest changes. </span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;"><em>*Test Coverage</em></span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;">Every day, Salesforce.com runs over 50,000 quality assurance tests on its own software. When Salesforce.com introduced the Apex customization language in 2009, mandatory test coverage was baked into the development model.  Salesforce.com provides a platform based on high-quality, thoroughly tested code, and expects custom developers to do the same. </span></div><div><span class="Apple-style-span" style="font-family:inherit;"><br></span></div><div><span class="Apple-style-span" style="font-family:inherit;">If you are ready for a safe, reliable, professionally-maintained business platform, Salesforce.com, the original Software as a Service provider, is still the best. </span></div><div style="font-family:Arial;"><span class="Apple-style-span" style="font-family:Arial, Helvetica, sans-serif;font-size:x-small;"><br></span></div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/03/27/in-data-we-trust/" data-id="cizbl1w7l0041fcx3e98yerzh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Programming/">Programming</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-unloading-salesforce-crm-data-with-outbound-messages" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/03/22/unloading-salesforce-crm-data-with-outbound-messages/" class="article-date">
  <time datetime="2012-03-22T09:00:00.000Z" itemprop="datePublished">2012-03-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tutorials/">Tutorials</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/22/unloading-salesforce-crm-data-with-outbound-messages/">Unloading Salesforce CRM Data with Outbound Messages</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="separator" style="clear:both;text-align:center;"><a href="http://www.clker.com/" target="_blank" rel="external"><img src="http://www.clker.com/cliparts/6/9/f/3/11971239071443233733nicubunu_Message_in_a_Bottle.svg.med.png" alt=""></a></div>No software application is an island, and Salesforce provides two great mechanisms for getting data in and out of your org. To get bits in, there’s the Data Loader and other tools that use the same APIs. To get data out, Salesforce provides a system for pushing outbound messages to an external web service.<br><br>Whenever data is edited, or some other internal event occurs, a Salesforce workflow can queue an outbound message to another system.<br><br>While there are several off-the-shelf tools for loading data, implementing an outbound message listener is still a custom affair that requires database and web development skills. If you don’t mind exposing an end-point to pass data to a stored procedure, then read on ..<br><br><a name="more"></a>There are plenty of devils in the details, but here’s the basic 1-2-3-4:<br><br>1.  A workflow rule queues an outbound message.<br>2.  The outbound message contains a bundle of fields from one of your Salesforce objects.<br>3.  A web service endpoint (that you create) receives the message and updates an external system (that you control).<br>4.  Optionally, the service responds and updates the original recordThe linch pin is step 3. While there are tools that simplify writing web services, you still need to write some code. The Salesforce API Developers Guide provides an <a href="http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_om_outboundmessaging_listener.htm" target="_blank" rel="external">example of a simple listener class</a>, but it’s really a bit too simple.<br><div><br><pre>classMyNotificationListener : INotificationBinding<br>{<br>    publicnotificationsResponse notifications(notifications n)<br>    {<br>        notificationsResponse r = newnotificationsResponse();<br>        r.Ack = true;<br>        return r;<br>    }<br>}<br></pre><br>The notificationsResponse method is the end-point for a SOAP web services call. The message bundle is passed over as a “notification”.  If records are being updated in bulk (say by a data loader), Salesforce may include up to 100 notifications in a single SOAP envelope.   A better example of a notificationResponse would be:<br><br><pre><span class="Apple-style-span">classMyNotificationListener : INotificationBinding<br>{<br>    publicnotificationsResponse notifications(notifications n)<br>    {<br>        foreach (AccountNotification message in n.Notification)<br>        {<br>            // … handle message …</span><span class="Apple-style-span"><br>        }<br>        notificationsResponse r = newnotificationsResponse();<br>        r.Ack = true;<br>        return r;<br>    }<br>}<br></span></pre><br>Something to consider when handling a message is that Salesforce may send the same message multiple times. Each message has an ID, and if handling the same message twice would be a bad thing, you should cache the ID and check it before processing. Also, in real life, we should catch exceptions and log errors.<br><br><pre>log4net.ILog log = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);<br>foreach (AccountNotification message in n.Notification)<br>{<br>  sf = message.sObject;<br>  try<br>  {<br>    // – Have we met? –<br>    if (HttpRuntime.Cache[message.Id] != null)<br>    {<br>      log.Warn(string.Format(“Warn: SKIPPING (sf.id=\”{0}\”) in message (id=\”{1}\”)”, sf.Id, message.Id));<br>      continue;<br>    }<br>    lock (cacheLock)<br>    {<br>      // The cache will only last as long as the App Pool<br>      HttpRuntime.Cache.Insert(message.Id, sf.Id, null, System.Web.Caching.Cache.NoAbsoluteExpiration, TimeSpan.FromHours(2));<br>      log.Info(string.Format(“Info: PROCESSING (sf.id=\”{0}\”) in message (id=\”{1}\”)”,sf.Id, message.Id));<br>    }<br><br>    // … handle message …<br>  }<br>  catch (Exception ex)<br>  {<br>    // Catch any exceptions raised in foreach loop<br>    String errorMessage = ex.Message + “ — “ + ex.StackTrace;<br>    log.Error(String.Format(“Error: EXCEPTION (sf.id=\”{0}\”, error=\”{1}\””, sf.Id, ex.Message + “ — “ + ex.StackTrace));<br>        }<br>} // end foreach loop<br></pre><br>When developing an outbound message service, you should test it under maximum load. What will happen if someone uses the Apex Dataloader to touch every record in an object, potentially creating an outbound message for every record? If that happens, Salesforce is going to collect the bundles into envelopes of 100 records each, and send them down to your web service as quickly as it can. If your service can’t keep up, Salesforce will try again later, in increasing intervals, for up to 24 hours.<br><br>Under “Setup/Monitor/Outbound Messages”, Salesforce provides a display where you can watch the records pass through in real time. If in your tests, you see Salesforce binding up, it’s a good idea to queue the records, and process them at your system’s pace.<br><br>For .NET, one approach would be to spread-out the work using a ThreadPool, but a better approach can be to use a Producer/Consumer Queue. (The example code is written for .NET 3.5. A 4.0 implementation may differ. See <a href="http://www.amazon.com/gp/product/0596800959/ref=as_li_ss_tl?ie=UTF8&amp;tag=husteddotcom-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0596800959" target="_blank" rel="external">C# 4.0 in a Nutshell</a> for more examples and background information.)<br><br><pre>public notificationsResponse notifications(notifications n)<br>{<br>  log4net.ILog log = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);<br>  if (myQueue == null) lock (queueLock)<br>  {<br>    // Double-check pattern<br>    if (myQueue == null) myQueue = new AccountQueue();<br>  }<br>  log.Info(“Info: Enqueuing and acknowledging notifications”);<br>  myQueue.EnqueueTask(n);<br>  notificationsResponse r = new notificationsResponse();<br>  r.Ack = true;<br>  return r;<br>}<br><br>// Producer/Consumer Queue to throttle account upserts notifications<br>// and prevent swamping of server during DataLoader updates.<br>// <a href="http://www.albahari.com/threading/part2.aspx#_WaitHandle_Producer_Consumer_Queue" target="_blank" rel="external">http://www.albahari.com/threading/part2.aspx#_WaitHandle_Producer_Consumer_Queue</a><br>class AccountQueue : IDisposable<br>{<br>  EventWaitHandle _wh = new AutoResetEvent(false);<br>  Thread _worker;<br>  readonlyobject _locker = newobject();<br>  Queue _tasks = new Queue();<br>  public AccountQueue()<br>  {<br>    _worker = new Thread(Work);<br>    _worker.Start();<br>  }<br>  publicvoid EnqueueTask(notifications task)<br>  {<br>    lock (_locker) _tasks.Enqueue(task);<br>    _wh.Set();<br>  }<br>    publicvoid Dispose()<br>    {<br>        EnqueueTask(null);     // Signal the consumer to exit.<br>        _worker.Join();        // Wait for the consumer’s thread to finish.<br>        _wh.Close();           // Release any OS resources.<br>    }<br>    void Work()<br>    {<br>    while (true)<br>    {<br>      notifications task = null;<br>      lock (_locker)<br>        if (_tasks.Count &gt; 0)<br>        {<br>           task = _tasks.Dequeue();<br>           if (task == null) return;<br>        }<br>        if (task != null)<br>        {<br>          doWork(task);    // Handle message here<br>        }<br>        else<br>          _wh.WaitOne();   // No more tasks - wait for a signal<br>      }<br>   }<br>}<br><br>static readonly private object cacheLock = newobject();<br>static public void doWork(notifications n) {<br>     // … code from prior example …<br>}<br></pre><br>Along the way, we slipped in a reference to Log4Net. Configuring Log4Net is outside the scope of this article, but you can dig into the gory details at <a href="http://logging.apache.org/" target="_blank" rel="external">logging.apache.org</a>. Highly recommended!<br><br>While our non-trivial example has grown quickly, it does provide the backbone for a robust Listener that can keep pace with Salesforce, even when you are stuck with a pokey API or under-powered server.<br><br>In a <a href="http://tedhusted.blogspot.com/2012/03/catch-me-on-flip-side-responding-to.html" target="_blank" rel="external">followup blog</a>, we close the loop by showing how a listener can respond back to Salesforce.<br><br></div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/03/22/unloading-salesforce-crm-data-with-outbound-messages/" data-id="cizbl1wan0097fcx3nkr91cvq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-learn-salesforce-now" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/03/20/learn-salesforce-now/" class="article-date">
  <time datetime="2012-03-20T09:00:00.000Z" itemprop="datePublished">2012-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Reviews/">Reviews</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/20/learn-salesforce-now/">Learn. Salesforce. Now.</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><div class="separator" style="clear:both;text-align:center;"><a href="http://www.salesforce.com/customer-resources/learning-center/" target="_blank" rel="external"><img src="http://www2.sfdcstatic.com/common/assets/img/logo-new.png" alt=""></a></div>The job market for qualified Salesforce workers is booming, and as the economy recovers, it can only grow hotter. If you’re “transitioning”, now may be a great time to learn Salesforce and add another skill to your resume.  </p>
<p>While there is no substitute for work experience, Salesforce offers a dazzling array of self-service learning tools. Even better, you can <a href="http://www.developerforce.com/events/regular/registration.php" target="_blank" rel="external">create a free development</a> org and practice what you learn. Salesforce dev orgs expire after a year, and have some performance restrictions, but they are otherwise equivalent to a production org. Tracking your transition efforts can be great way to practice a new skill and step up your job search at the same time.  </p>
<p><a name="more"></a>A great starting point is to <a href="http://certification.salesforce.com/" target="_blank" rel="external">target certification</a>. By studying for the exam, you expose yourself to the depth and breadth of the Salesforce platform. (<a href="http://nimbleuser.com/_Blogs/Nimble_News/Nimble_News/Salesforce_Certification_-_A_Win/Win.aspx" target="_blank" rel="external">See my certification blog for more</a>.)</p>
<p>If you are a visual learner, <a href="http://www.youtube.com/user/dreamforce" target="_blank" rel="external">YouTube is brimming with juicy Salesforce videos</a>. Everyone might not be able to fly to SFO for DreamForce, but anyone can enjoy the presentations online, from the comfort of a local Internet connection.</p>
<p>For old-school learners, <a href="http://www.amazon.com/gp/product/0470590718/ref=as_li_ss_tl?ie=UTF8&amp;tag=husteddotcom-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0470590718" target="_blank" rel="external">Salesforce.com For Dummies</a>,   <a href="http://www.amazon.com/gp/product/0137140762/ref=as_li_ss_tl?ie=UTF8&amp;tag=husteddotcom-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0137140762" target="_blank" rel="external">Salesforce.com Secrets of Success</a>,   <a href="http://www.amazon.com/gp/product/1446108538/ref=as_li_ss_tl?ie=UTF8&amp;tag=husteddotcom-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1446108538" target="_blank" rel="external">Salesforce Handbook</a>, and   <a href="http://www.amazon.com/gp/product/0321767357/ref=as_li_ss_tl?ie=UTF8&amp;tag=husteddotcom-20&amp;linkCode=as2&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0321767357" target="_blank" rel="external">Development with the Force.com Platform</a>,   are a fantastic foursome. And, if you’d like to keep it all on the cloud, all four are also available for the Amazon Kindle.  </p>
<p>They say when one door closes, another one opens. Today is the first day of Spring, and it could be a great day to open up to the many opportunities available on and around Salesforce CRM.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/03/20/learn-salesforce-now/" data-id="cizbl1w7t004jfcx3yk47dfp7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-toggling-pdf-mode-in-a-visualforce-apex-page" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2012/03/15/toggling-pdf-mode-in-a-visualforce-apex-page/" class="article-date">
  <time datetime="2012-03-15T09:00:00.000Z" itemprop="datePublished">2012-03-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Tutorials/">Tutorials</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/15/toggling-pdf-mode-in-a-visualforce-apex-page/">Toggling PDF Mode In a Visualforce Apex Page</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><div class="separator" style="clear:both;text-align:center;"><a href="http://onsoftware.en.softonic.com/top-free-tools-to-open-create-and-edit-pdf-documents" target="_blank" rel="external"><img src="http://screenshots.en.sftcdn.net/blog/en/2009/02/pdfbotoncico.png" alt=""></a></div>Salesforce.com has made it easy to blend custom Visualforce pages into a standard Salesforce CRM site. Using the standard stylesheets and a smattering of markup, we can cobble up a custom Account, Contact, or Opportunity page, with an absolute minimum of effort.  </p>
<p>It’s also easy to construct a wholly custom page resemble a native Salesforce CRM page. While the page looks great, it may not be printer-friendly, and users may have trouble sharing the output with their non-Salesforce brethren. One solution is to render the pages as a very-printable PDF. Salesforce.com has also made the PDF option blazingly easy. Just include a “renderas=PDF” attribute at the top of your page and – voilà – instant PDF.   </p>
<p><a name="more"></a>Of course,  we don’t want to maintain two versions of the page, or give either our pretty or printable versions, and so the next thing is be able to switch between the HTML and PDF versions.  </p>
<p>Happily, there is a <a href="http://blogs.developerforce.com/developer-relations/2008/06/dynamically-cho.html" target="_blank" rel="external">venerable blog posting</a> that provides a great leg up, but I ran into an issue where I wanted to offer another option on top of PDF/HTML.  </p>
<p>Aside from PDF printing, we also wanted to support two flavors of the same database query. One version aggregated rows with a status column set to either “Value A” or “Value B”, and a second version aggregated rows set to “Value C”. Our case was different, but a common case might a report that showed “Cold or Warm” leads, and another that showed only “Hot” leads.  </p>
<p>Bottom line is that we wanted to present the page as either HTML or PDF, using either Query A or Query B, and keep all the markup and source code together.  </p>
<p>Here’s my solution:  </p>
<p><div class="separator" style="clear:both;text-align:center;"></div><div class="separator" style="clear:both;text-align:center;"><a href="https://tedhusted.files.wordpress.com/2012/03/9173f-pdf-foo.png" target="_blank" rel="external"><img src="https://tedhusted.files.wordpress.com/2012/03/9173f-pdf-foo.png?w=300" alt=""></a></div><br><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;white-space:pre;">// and the backend </span></p>
<p><pre><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;"><span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;"><br>/**</span></span></pre></p>
<ul>
<li><p>Computes and transforms data for use by the Campaign Profile page.<br>*/<br>public class Foo_Ctrl {</p>
<p> // PDF parameter.<br> private final static String PDF = ‘p’;</p>
<p> // HTML parameter.<br> private final static String MODE = ‘m’;</p>
<p> // Stores Account to use with the Campaign Profile.<br> private Account myAccount = null;</p>
<p> // Stores set of query constraints based on Mode parameter.<br> // “AND My_Mode__c IN :myMode”<br> private Set myMode = null;    </p>
<p> // Assembles and returns URI reflecting current parameter settings.<br> private String doEnable(Boolean doPDF, Boolean doRollup) {</p>
<pre><code>String parameters = &apos;/apex/Foo?&apos;;
if (myAccount!=null) parameters += &apos;id=&apos; + MyID;
if (doPDF) parameters += &apos;&amp;amp;&apos; + PDF + &apos;=true&apos;;
if (doRollup) parameters += &apos;&amp;amp;&apos; + MODE + &apos;=true&apos;;
return parameters;
</code></pre><p> }</p>
<p> /**</p>
<ul>
<li><p>Stores current or desired state “Status”.<br>*/<br>public boolean IsModeB { get; set; }</p>
<p>/**</p>
</li>
<li><p>Reflects absence of “Rollup” parameter.<br>*/<br>public boolean IsModeA {<br> get {return !IsModeB;}<br> set {IsModeB = !value;}<br>}   </p>
<p>/**</p>
</li>
<li><p>Handles runtime “PDF” parameter ‘p’.<br>*/<br>public boolean IsPDF { get; set; }</p>
<p>/**</p>
</li>
<li><p>Reflects absence of “PDF” parameter.<br>*/<br>public boolean IsHTML {<br> get {return !IsPDF;}<br> set {IsPDF = !value;}<br>}   </p>
<p>/**</p>
</li>
<li><p>Returns current account ID, or null.<br>*/<br>public Id MyId {<br> get {return (myAccount==null) ? null : myAccount.Id;}<br>}</p>
<p>/**</p>
</li>
<li>Returns updated URI including PDF parameter,</li>
<li><p>and the current value of MODE parameter.<br>*/<br>public String doEnablePDF {<br> get{return doEnable(true,IsModeB);}<br>}</p>
<p>/**</p>
</li>
<li>Returns updated URI excluding PDF parameter,</li>
<li><p>and the including current value of MODE parameter.<br>*/<br>public String doEnableHTML {<br> get{return doEnable(false,IsModeB);}<br>}</p>
<p>/**</p>
</li>
<li>Returns updated URI including MODE parameter,</li>
<li><p>and the current value of PDF parameter.<br>*/<br>public String doEnableModeB {<br> get{return doEnable(IsPDF,true);}<br>}</p>
<p>/**</p>
</li>
<li>Returns updated URI excluding MODE parameter,</li>
<li><p>and including the current value of PDF parameter.<br>*/<br>public String doEnableModeA {<br> get{return doEnable(IsPDF,false);}<br>}</p>
<p>/**</p>
</li>
<li>Constructs the controller object, capturing the current Account and year.<br>*/<br>public Foo_Ctrl(ApexPages.StandardController controller) {<br> if (controller.getId() == null) {<pre><code>ApexPages.addMessage(new ApexPages.Message(ApexPages.Severity.Error, &apos;Id is required&apos;));
</code></pre> } else {<pre><code>if (myAccount == null) myAccount = (Account) controller.getRecord();
</code></pre> }<br> // Instatiate the rest, to avoid runtime errors …<br> IsPDF = (ApexPages.currentPage().getParameters().get(PDF)==’true’);<br> IsModeB = (ApexPages.currentPage().getParameters().get(MODE)==’true’);<br> myMode = new Set();<br> if (IsModeB) {<pre><code>myMode.add(&apos;Status B&apos;);
myMode.add(&apos;Status C&apos;);
</code></pre> } else {<pre><code>myMode.add(&apos;Status A&apos;);
</code></pre> }<br>}<br>}</li>
</ul>
</li>
</ul>
<p>// And, of course, a test suite</p>
<p>@IsTest<br>public class NU_TEST_Foo_Page {</p>
<pre><code>static Account myAccount = null;
static Foo_Ctrl myCtrl = null;
</code></pre><p>   static private void mySetUp() {<br>        Test.setCurrentPageReference(Page.Foo);<br>        // Constructor Scaffolding<br>        if (myAccount==null) {<br>            myAccount = new Account(name=’Alpha Bravo’,<br>            NU_Andar_Account_Number__c=’1’);<br>            insert myAccount;<br>            myCtrl = new Foo_Ctrl(new ApexPages.StandardController(myAccount));<br>        }<br>    }</p>
<pre><code>static testMethod void PDF_Test() {
    mySetUp();
    String nextPage = myCtrl.doEnablePDF;
    System.assertEquals(&apos;/apex/Foo?id=&apos; + myAccount.Id + &apos;&amp;amp;&apos; + Foo_Ctrl.PDF + &apos;=true&apos;,nextPage);
}

static testMethod void HTML_Test() {
    mySetUp();
    String nextPage = myCtrl.doEnableHTML;
    System.assertEquals(&apos;/apex/Foo?id=&apos; + myAccount.Id + &apos;&apos;,nextPage);         
}

static testMethod void ModeB_Test() {
    mySetup();
    String nextPage = myCtrl.doEnableModeB;
    System.assertEquals(&apos;/apex/Foo?id=&apos; + myAccount.Id + &apos;&amp;amp;&apos; + Foo_Ctrl.MODE + &apos;=true&apos;,nextPage);
}

static testMethod void ModeA_Test() {
    mySetUp();
    String nextPage = myCtrl.doEnableModeA;
    System.assertEquals(&apos;/apex/Foo?id=&apos; + myAccount.Id + &apos;&apos;,nextPage);         
}

static testMethod void PDF_ModeB_Test() {
    mySetUp();
    ApexPages.currentPage().getParameters().put(Foo_Ctrl.PDF, &apos;true&apos;);
    Foo_Ctrl ctrlPDF = new Foo_Ctrl(new ApexPages.StandardController(myAccount));
    String nextPage = ctrlPDF.doEnableModeB;
    System.assertEquals(&apos;/apex/Foo?id=&apos; + myAccount.Id + &apos;&amp;amp;&apos; + Foo_Ctrl.PDF + &apos;=true&apos; + &apos;&amp;amp;&apos; + Foo_Ctrl.MODE + &apos;=true&apos;,nextPage);
    System.assertEquals(true,ctrlPDF.isPDF);
    System.assertEquals(false,ctrlPDF.isHTML);
    ctrlPDF.isHTML = true;
    System.assertEquals(false,ctrlPDF.isPDF);
}

static testMethod void ModeB_PDF_Test() {
    mySetUp();
    ApexPages.currentPage().getParameters().put(Foo_Ctrl.MODE, &apos;true&apos;);
    Foo_Ctrl ctrlMode = new Foo_Ctrl(new ApexPages.StandardController(myAccount));
    String nextPage = ctrlMode.doEnablePDF;
    System.assertEquals(true,ctrlMode.isModeB);
    System.assertEquals(false,ctrlMode.isModeA);       
    System.assertEquals(&apos;/apex/Foo?id=&apos; + myAccount.Id + &apos;&amp;amp;&apos; + Foo_Ctrl.PDF + &apos;=true&apos; + &apos;&amp;amp;&apos; + Foo_Ctrl.MODE + &apos;=true&apos;,nextPage);
}

 static testMethod void PDF_Flag_Test() {
    mySetUp();
    ApexPages.currentPage().getParameters().put(Foo_Ctrl.PDF, &apos;true&apos;);
    Foo_Ctrl ctrlPDF = new Foo_Ctrl(new ApexPages.StandardController(myAccount));
    System.assertEquals(true,ctrlPDF.isPDF);
    System.assertEquals(false,ctrlPDF.isHTML);
    ctrlPDF.isHTML = true;
    System.assertEquals(false,ctrlPDF.isPDF);
}

 static testMethod void Mode_Flag_Test() {
    mySetUp();
    ApexPages.currentPage().getParameters().put(Foo_Ctrl.MODE, &apos;true&apos;);
    Foo_Ctrl ctrlMode = new Foo_Ctrl(new ApexPages.StandardController(myAccount));
    System.assertEquals(true,ctrlMode.isModeB);
    System.assertEquals(false,ctrlMode.isModeA);
    ctrlMode.isModeA = true;
    System.assertEquals(false,ctrlMode.isModeB);
}
</code></pre><p>}<span class="Apple-style-span" style="font-family:'Courier New', Courier, monospace;font-size:x-small;"><br></span><br><span class="Apple-style-span" style="font-family:inherit;">For more Visualforce PDF trickery, <a href="http://force.siddheshkabe.co.in/2011/04/some-pdf-tricks-on-visualforce.html" target="_blank" rel="external">see this nifty blog</a> on May The Force Be With You.  </span></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://TedHusted.github.io/2012/03/15/toggling-pdf-mode-in-a-visualforce-apex-page/" data-id="cizbl1waj008zfcx39eot4yo8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Salesforce/">Salesforce</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Visualforce/">Visualforce</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Essays/">Essays</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Events/">Events</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reviews/">Reviews</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tutorials/">Tutorials</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ASF/">ASF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ajax/">Ajax</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache-Roller/">Apache Roller</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache-Struts/">Apache Struts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Business-Analysis/">Business Analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Continuous-Integration/">Continuous Integration</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Force-com/">Force.com</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Apps/">Google Apps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Code/">Google Code</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google-Wave/">Google Wave</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Home-Office/">Home Office</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hudson/">Hudson</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IIBA-Rochester/">IIBA Rochester</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/">Jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Open-Source/">Open Source</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Productivity/">Productivity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Programming/">Programming</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rochester-NY/">Rochester NY</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Salesforce/">Salesforce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Satire/">Satire</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Social-Media/">Social Media</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tour-de-Blog/">Tour de Blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Visualforce/">Visualforce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web-Development/">Web Development</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YUI/">YUI</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ASF/" style="font-size: 15.83px;">ASF</a> <a href="/tags/Ajax/" style="font-size: 18.33px;">Ajax</a> <a href="/tags/Apache-Roller/" style="font-size: 12.5px;">Apache Roller</a> <a href="/tags/Apache-Struts/" style="font-size: 20px;">Apache Struts</a> <a href="/tags/Business-Analysis/" style="font-size: 12.5px;">Business Analysis</a> <a href="/tags/Continuous-Integration/" style="font-size: 10px;">Continuous Integration</a> <a href="/tags/Force-com/" style="font-size: 10.83px;">Force.com</a> <a href="/tags/Google-Apps/" style="font-size: 11.67px;">Google Apps</a> <a href="/tags/Google-Code/" style="font-size: 10.83px;">Google Code</a> <a href="/tags/Google-Wave/" style="font-size: 11.67px;">Google Wave</a> <a href="/tags/Home-Office/" style="font-size: 10px;">Home Office</a> <a href="/tags/Hudson/" style="font-size: 10px;">Hudson</a> <a href="/tags/IIBA-Rochester/" style="font-size: 10.83px;">IIBA Rochester</a> <a href="/tags/Jenkins/" style="font-size: 10px;">Jenkins</a> <a href="/tags/Open-Source/" style="font-size: 15px;">Open Source</a> <a href="/tags/Productivity/" style="font-size: 17.5px;">Productivity</a> <a href="/tags/Programming/" style="font-size: 19.17px;">Programming</a> <a href="/tags/Rochester-NY/" style="font-size: 13.33px;">Rochester NY</a> <a href="/tags/Salesforce/" style="font-size: 16.67px;">Salesforce</a> <a href="/tags/Satire/" style="font-size: 12.5px;">Satire</a> <a href="/tags/Social-Media/" style="font-size: 13.33px;">Social Media</a> <a href="/tags/Tour-de-Blog/" style="font-size: 10.83px;">Tour de Blog</a> <a href="/tags/Visualforce/" style="font-size: 10px;">Visualforce</a> <a href="/tags/Web-Development/" style="font-size: 10px;">Web Development</a> <a href="/tags/YUI/" style="font-size: 14.17px;">YUI</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">January 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">November 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/06/">June 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/01/">January 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">July 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">May 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/11/">November 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/08/">August 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/07/">July 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/04/">April 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/03/">March 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/02/">February 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/01/">January 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/12/">December 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/11/">November 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/10/">October 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/09/">September 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/07/">July 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/06/">June 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/01/">January 2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/12/">December 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/09/">September 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/08/">August 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/07/">July 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/06/">June 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/05/">May 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/04/">April 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/03/">March 2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/11/">November 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/10/">October 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/09/">September 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/06/">June 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/05/">May 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/04/">April 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/03/">March 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/02/">February 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2006/01/">January 2006</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2004/04/">April 2004</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2003/04/">April 2003</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2012/05/05/a-nimble-introduction-to-force-com/">A Nimble Introduction to Force.com</a>
          </li>
        
          <li>
            <a href="/2012/04/26/office-data-silos-considered-harmful/">Office Data Silos Considered Harmful</a>
          </li>
        
          <li>
            <a href="/2012/04/07/failing-safe-with-the-apex-data-loader-for-salesforce/">Failing safe with the Apex Data Loader for Salesforce</a>
          </li>
        
          <li>
            <a href="/2012/04/04/salesforce-open-source-pioneer/">Salesforce – Open Source Pioneer</a>
          </li>
        
          <li>
            <a href="/2012/04/01/sun-goes-nova-cloud-intact/">Sun goes Nova. Cloud intact.</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Ted Husted<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>